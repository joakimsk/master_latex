\chapter{Onvif}
\paragraph{Introduction}
Onvif is a recent IP-camera standard. The camera is controlled through Onvif-S specification, used as a web service with SOAP.

There exists various versions of the Onvif standard.

The Q6045 supports the ONVIF 1.02 standard with firmware 5.25 or higher.

\paragraph{gSOAP for Onvif-S}
Following our example in the gSOAP Appendix, we will now generate a gSOAP code stub for Onvif, using the devicemanagement service.

We copy the typemap.dat from gsoap root folder, which, conveniently, describes the onvif namespaces. The gSOAP FAQ also contains details about ONVIF.


We download the wsdl and create a header-file, describing the service.
\begin{lstlisting}[style=BashInputStyle]
    wsdl2h -o devicemgmt.h http://www.onvif.org/onvif/ver10/device/wsdl/devicemgmt.wsdl
\end{lstlisting}

We construct the code stubs for the client in C++ and output the files to directory ccp\_files.
\begin{lstlisting}[style=BashInputStyle]
    soapcpp2 -C -d cpp_files -i devicemgmt.h
\end{lstlisting}



\paragraph{OpenSSL on Windows}
OpenSSL is required by gSOAP to deliver the HTTP Digest Authentication feature. ONVIF is using this as an authentication type, and is required for most functions.

The authentication mode as implemented by Axis Communications using ONVIF 1.02 and how to configure login can be seen in a standalone document.

\paragraph{Useful resources} The ONVIF standard is a highly verbose standard. To implement it in a good manner, it is suggested to use gSOAP, and the following resources are provided for future work.
\url{https://www.cs.fsu.edu/~engelen/soapfaq.html}
\url{http://www.axis.com/files/tech_notes/FuncDesc-Authentication_in_ONVIF_and_VAPIX_v1.1.pdf}
\url{http://www.onvif.org/onvif/ver10/ptz/wsdl/ptz.wsdl}
\url{http://www.onvif.org/onvif/ver10/device/wsdl/devicemgmt.wsdl}
\url{http://wiki.agocontrol.com/index.php/ONVIF_GSOAP_Development}
\url{http://pdn.pelco.com/content/developing-onvif-c-client-application-0}
\url{http://www.onvif.org/Portals/0/documents/op/20984_11763r01ONVIF_Members-Profile_S_Specification.pdf}